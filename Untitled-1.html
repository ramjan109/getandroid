<!doctype html>
<html lang="bn">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Get- Android </title>
<style>
/* ========================
   Mobile-first styles
   ======================== */

/* Palette (42 colors assigned to fixed vars) */
:root{
  --p1:#b79f92;  --p2:#896b5a;  --p3:#ad9283;  --p4:#7a5f50;  --p5:#997764;
  --p6:#6b5346;  --p7:#a28f88;  --p8:#937c74;  --p9:#836960;  --p10:#74574c;
  --p11:#644438; --p12:#6a4a3b; --p13:#710000; --p14:#001125; --p15:#002c5e;
  --p16:#003f87; --p17:#710000; --p18:#352347; --p19:#3b274f; --p20:#553872;
  --p21:#7a51a3; --p22:#710000; --p23:#bd0000; --p24:#ff9fd0; --p25:#9966cc;
  --p26:#e86100; --p27:#e1f2c8; --p28:#f28500; --p29:#ffae42; --p30:#56887d;
  --p31:#664228; --p32:#f3e5ab; --p33:#a75502; --p34:#722f37; --p35:#3d7a42;
  --p36:#437b52; --p37:#fcd725; --p38:#f3bcaf; --p39:#e9b432; --p40:#bac7ce;
  --p41:#78866b; --p42:#acb75c;

  --bg: #fffdfb;
  --card: #ffffff;
  --muted: #6b7280;
  --accent: var(--p28);
  --neutral-border: var(--p42);
  --gap: 12px;
  --radius: 12px;
  --touch: 48px;
  --container: 100%;
}

/* base reset */
*{box-sizing:border-box}
html,body{height:100%}
body{margin:0;font-family:Inter,system-ui,-apple-system,"Segoe UI",Roboto,"Helvetica Neue",Arial;background:var(--bg);color:#111;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}
a{color:inherit;text-decoration:none}
button{font-family:inherit}

/* top header (compact) */
.header{
  position:sticky;top:0;z-index:120;background:linear-gradient(90deg,var(--p1),var(--p2));padding:10px 12px;
  display:flex;align-items:center;gap:10px;border-bottom:1px solid rgba(0,0,0,0.06);
}
.brand{display:flex;align-items:center;gap:10px;flex:0 0 auto;cursor:pointer}
.brand-logo{width:40px;height:40px;border-radius:9px;background:var(--p3);display:flex;align-items:center;justify-content:center;overflow:hidden;box-shadow:0 6px 18px rgba(0,0,0,0.12)}
.brand-logo img{height:26px;width:auto}
.brand-title{font-weight:800;color:var(--p4);font-size:16px}

/* search + hamburger aligned — mobile: search then hamburger to right */
.header-right{display:flex;align-items:center;gap:8px;margin-left:auto;flex:1 1 auto}
.search-wrap{display:flex;align-items:center;gap:8px;background:rgba(255,255,255,0.9);padding:6px;border-radius:10px;flex:1;min-width:0}
.search-wrap input{border:0;outline:0;font-size:15px;padding:8px 6px;width:100%;background:transparent}
.hamburger{background:var(--p6);border:0;color:#fff;width:44px;height:44px;border-radius:10px;display:inline-flex;align-items:center;justify-content:center;font-size:18px;cursor:pointer}

/* main container (mobile-first full width) */
.main{padding:12px;max-width:100%;margin:0 auto}

/* News hero simplified mobile-first */
.news-hero{background:linear-gradient(180deg,var(--p7),var(--p8));color:#fff;padding:14px;border-radius:12px;display:flex;flex-direction:column;gap:10px}
.news-hero h1{margin:0;font-size:18px;line-height:1.1}
.news-hero p{margin:0;opacity:0.95;font-size:13px}
.hero-img{width:100%;height:150px;border-radius:10px;overflow:hidden;background:var(--p9);display:block}
.hero-img img{width:100%;height:100%;object-fit:cover}

/* sections */
.section{margin-top:16px}
.section-head{display:flex;align-items:center;justify-content:space-between;margin-bottom:10px}
.section-head h3{margin:0;font-size:15px}
.viewall{background:var(--accent);color:#fff;padding:8px 10px;border-radius:8px;font-weight:700;font-size:13px}

/* single-column card lists for mobile */
.list{display:grid;grid-template-columns:1fr;gap:10px}
.card{background:var(--card);border-radius:10px;padding:12px;display:flex;gap:12px;align-items:center;border:1px solid rgba(0,0,0,0.04);cursor:pointer}
.card .icon{width:64px;height:64px;border-radius:12px;overflow:hidden;flex:0 0 64px;display:flex;align-items:center;justify-content:center;background:#eee}
.card .icon img{width:100%;height:100%;object-fit:cover}
.card .meta h4{margin:0;font-size:16px}
.card .meta p{margin:6px 0 0 0;color:var(--muted);font-size:13px}

/* featured list smaller items */
.featured-item{display:flex;gap:10px;align-items:center;padding:8px;border-radius:8px}
.featured-item .thumb{width:48px;height:48px;border-radius:8px;overflow:hidden;flex:0 0 48px;display:flex;align-items:center;justify-content:center;background:#eee}
.featured-item .title{font-weight:700;font-size:14px}

/* search results area */
#searchResults{display:none;margin-top:12px}
.results-grid{display:grid;grid-template-columns:1fr;gap:10px}

/* modal (centered) */
.modal-backdrop{position:fixed;inset:0;background:rgba(0,0,0,0.5);display:none;align-items:center;justify-content:center;padding:16px;z-index:220}
.modal{background:var(--card);width:100%;max-width:760px;border-radius:12px;padding:14px;box-shadow:0 20px 60px rgba(0,0,0,0.25)}
.modal .m-top{display:flex;gap:12px;align-items:center}
.m-icon{width:92px;height:92px;border-radius:12px;overflow:hidden;flex:0 0 92px;background:#f5f5f5}
.m-icon img{width:100%;height:100%;object-fit:contain}
.modal h2{margin:0;font-size:18px}
.modal p{margin:8px 0;color:var(--muted)}

/* modal actions (big touch targets) */
.modal-actions{display:flex;gap:10px;margin-top:12px;flex-wrap:wrap}
.btn{padding:10px 12px;border-radius:10px;border:0;font-weight:700;cursor:pointer}
.btn-primary{background:var(--p28);color:#fff}
.btn-copy{background:var(--p29);color:#111}
.btn-open{background:var(--p30);color:#fff}

/* admin modal full-screen on mobile */
.admin-backdrop{position:fixed;inset:0;background:rgba(0,0,0,0.5);display:none;align-items:flex-start;justify-content:center;padding:12px;z-index:230}
.admin-panel{background:var(--card);width:100%;max-width:980px;border-radius:12px;padding:12px;box-shadow:0 18px 40px rgba(0,0,0,0.18)}
.form-row{display:grid;grid-template-columns:1fr;gap:8px}
.form-row .two{display:grid;grid-template-columns:1fr 1fr;gap:8px}

/* admin list */
.admin-list{margin-top:10px;max-height:260px;overflow:auto;border-top:1px dashed rgba(0,0,0,0.06);padding-top:8px}

/* side menu (right slide) */
.side-backdrop{position:fixed;inset:0;background:rgba(0,0,0,0.28);display:none;z-index:240}
.side-menu{position:fixed;top:0;right:-100%;width:320px;max-width:100%;height:100vh;background:linear-gradient(180deg,var(--p31),var(--p32));padding:18px;z-index:245;display:flex;flex-direction:column;gap:12px;transition:right .28s ease}
.side-menu.open{right:0}
.side-menu .close{background:var(--p33);border:0;color:#fff;padding:10px;border-radius:10px;font-weight:700;align-self:flex-end;cursor:pointer}
.side-menu nav a{display:block;padding:12px 10px;border-radius:8px;color:#fff;font-weight:800;margin-top:6px;background:rgba(255,255,255,0.04)}

/* footer compact */
.footer{margin-top:18px;padding:16px;border-radius:10px;background:var(--p35);color:#fff}
.footer h4{margin:0 0 8px 0;color:var(--p36);font-size:15px}
.footer p{margin:0;color:rgba(255,255,255,0.9);font-size:13px}

/* utilities */
.small{font-size:13px;color:var(--muted)}
.center{display:flex;align-items:center;justify-content:center}

/* larger screens (tablet/desktop) - enhance layout */
@media(min-width:720px){
  :root{ --container:1150px; }
  .main{max-width:var(--container);margin:12px auto;padding:12px}
  .list{grid-template-columns:repeat(3,1fr);gap:14px}
  .card{flex-direction:column;align-items:flex-start;padding:14px}
  .card .icon{width:100%;height:120px;border-radius:8px;flex:0 0 auto}
  .card .meta h4{font-size:16px}
  .news-hero{flex-direction:row;align-items:center;padding:22px}
  .hero-img{width:260px;height:160px}
  .section-head h3{font-size:18px}
  .results-grid{grid-template-columns:repeat(2,1fr)}
  .admin-panel{max-width:980px}
  .form-row{grid-template-columns:1fr 1fr; gap:10px}
  .form-row .two{grid-template-columns:1fr 1fr}
}

/* desktop wide */
@media(min-width:1120px){
  .list{grid-template-columns:repeat(3,1fr)}
  .results-grid{grid-template-columns:repeat(3,1fr)}
}

/* small visual tweaks */
::-webkit-scrollbar{height:8px;width:8px}
::-webkit-scrollbar-thumb{background:rgba(0,0,0,0.08);border-radius:8px}
</style>
</head>
<body>

<!-- Header -->
<header class="header" role="banner">
  <div class="brand" id="logoArea" title="13 বার ক্লিক করে Admin খুলুন" aria-label="Open admin">
    <div class="brand-logo"><img src="https://i.ibb.co.com/WWprNSxr/be8c5d4b-2753-4529-969d-8cc16f606370.jpg" alt="logo"></div>
    <div class="brand-title">Get- Android</div>
  </div>

  <div class="header-right">
    <div class="search-wrap" role="search">
      <input id="search" placeholder="Search apps, category, tags..." aria-label="Search apps" />
    </div>
    <button class="hamburger" id="hambBtn" aria-label="Open menu">☰</button>
  </div>
</header>

<!-- Side menu -->
<div id="sideBackdrop" class="side-backdrop" style="display:none" onclick="closeSide()"></div>
<aside id="sideMenu" class="side-menu" aria-hidden="true">
  <button class="close" id="sideCloseBtn" aria-label="Close menu">Close ✕</button>
  <nav aria-label="Primary">
    <a href="#home" onclick="closeSide()">HOME</a>
    <a href="#appsSection" onclick="closeSide()">APPS</a>
    <a href="#gamesSection" onclick="closeSide()">GAMES</a>
    <a href="#newsSection" onclick="closeSide()">NEWS</a>
  </nav>
  <div style="margin-top:auto;color:#fff;font-weight:700">Premium features</div>
  <div style="color:rgba(255,255,255,0.95)">Ad-free • Priority updates • Editor picks</div>
</aside>

<!-- Main -->
<main class="main" id="home">
  <!-- Search results -->
  <section id="searchResults" aria-live="polite">
    <div class="section-head"><h3>Search results</h3><div id="resultsCount" class="small"></div></div>
    <div id="resultsGrid" class="results-grid"></div>
  </section>

  <!-- News hero -->
  <section class="news-hero" id="newsSection" aria-labelledby="news-heading">
    <div class="left">
      <h1 id="news-heading">Latest Android News & Highlights</h1>
      <p>Curated headlines, trending releases and editor picks — updated regularly.</p>
      <div style="margin-top:8px"><a class="viewall" href="#newsSection">Explore all news</a></div>
    </div>
    <div class="hero-img"><img src="https://i.ibb.co.com/N6ZLc8tD/1753644539114-netflix.jpg" alt="featured banner"></div>
  </section>

  <!-- Featured + Indispensable -->
  <section class="section" id="appsSection">
    <div class="section-head">
      <h3>INDISPENSABLE ON YOUR PHONE</h3>
      <a class="viewall" href="#appsSection">View all</a>
    </div>

    <div id="indispensable" class="list" aria-live="polite"></div>
  </section>

  <!-- Editor's Choice -->
  <section class="section" id="editorsSection">
    <div class="section-head"><h3>Editor's Choice</h3><a class="viewall" href="#editorsSection">View all</a></div>
    <div id="editors" class="list"></div>
  </section>

  <!-- Games -->
  <section class="section" id="gamesSection">
    <div class="section-head"><h3>Games - Latest</h3><a class="viewall" href="#gamesSection">View all</a></div>
    <div id="games" class="list"></div>
  </section>

  <!-- Premium -->
  <section class="section" id="premiumSection">
    <div class="section-head"><h3>Premium - Latest</h3><a class="viewall" href="#premiumSection">View all</a></div>
    <div id="premium" class="list"></div>
  </section>

  <!-- Categories -->
  <section class="section" id="categoriesSection">
    <div class="section-head"><h3>Apps - Categories</h3><a class="viewall" href="#categoriesSection">View all</a></div>
    <div id="categories" class="list" style="gap:8px"></div>
  </section>

  <!-- Footer -->
  <footer class="footer" role="contentinfo">
    <div style="display:flex;gap:12px;align-items:center;justify-content:space-between;flex-wrap:wrap">
      <div style="display:flex;gap:10px;align-items:center">
        <img src="https://i.ibb.co/yourlogo.png" alt="logo" style="width:36px;height:36px;border-radius:8px">
        <div>
          <div style="font-weight:800">Get- Android</div>
          <div class="small">Curated Android apps — fast downloads & editor picks</div>
        </div>
      </div>
      <div style="font-size:13px;color:rgba(255,255,255,0.9)">© <span id="year"></span> Get- Android</div>
    </div>
  </footer>
</main>

<!-- Modal (app details) -->
<div id="modalBackdrop" class="modal-backdrop" onclick="if(event.target===this) closeModal()">
  <div class="modal" role="dialog" aria-modal="true" aria-label="App details">
    <div class="m-top">
      <div class="m-icon" id="modalIcon"><img src="" alt=""></div>
      <div>
        <h2 id="modalTitle">App Title</h2>
        <div id="modalMeta" class="small"></div>
        <p id="modalDesc" class="small"></p>
      </div>
    </div>
    <div class="modal-actions">
      <a id="modalDownload" class="btn btn-primary" href="#" target="_blank">Download</a>
      <button id="modalCopy" class="btn btn-copy">Copy link</button>
      <a id="modalOpen" class="btn btn-open" href="#" target="_blank">Open</a>
      <div id="modalDLCount" class="small" style="margin-left:auto;align-self:center">Downloads: 0</div>
    </div>
  </div>
</div>

<!-- Admin modal (open via 4x click on brand) -->
<div id="adminBackdrop" class="admin-backdrop" onclick="if(event.target===this) closeAdmin()">
  <div class="admin-panel" role="dialog" aria-modal="true" aria-label="Admin Manage Apps">
    <div style="display:flex;justify-content:space-between;align-items:center;gap:8px">
      <div style="font-weight:800">Admin — Manage Apps</div>
      <div style="display:flex;gap:8px">
        <button id="exportJsonBtn" class="btn" style="background:#fff">Export JSON</button>
        <button id="closeAdminBtn" class="btn" style="background:#fff">Close</button>
      </div>
    </div>

    <div style="margin-top:10px;display:flex;gap:8px;align-items:center">
      <input id="adminSearch" placeholder="Search apps to edit..." style="padding:10px;border-radius:10px;border:1px solid var(--neutral-border);flex:1">
      <button id="adminNewBtn" class="btn" style="background:var(--p40)">New</button>
    </div>

    <form id="appForm" style="margin-top:10px">
      <div class="form-row">
        <input id="fTitle" placeholder="Title" required style="padding:10px;border-radius:10px;border:1px solid var(--neutral-border)">
        <input id="fShort" placeholder="ShortDesc" style="padding:10px;border-radius:10px;border:1px solid var(--neutral-border)">
        <div class="two">
          <input id="fVersion" placeholder="Version" style="padding:10px;border-radius:10px;border:1px solid var(--neutral-border)">
          <input id="fSize" placeholder="Size" style="padding:10px;border-radius:10px;border:1px solid var(--neutral-border)">
        </div>
        <input id="fPremium" placeholder="Premium (text)" style="padding:10px;border-radius:10px;border:1px solid var(--neutral-border)">
        <input id="fIcon" placeholder="Icon URL" style="padding:10px;border-radius:10px;border:1px solid var(--neutral-border)">
        <select id="fCategorySelect" style="padding:10px;border-radius:10px;border:1px solid var(--neutral-border)"></select>
        <div id="newCategoryWrap" style="display:none"><input id="fCategoryNew" placeholder="New category" style="padding:10px;border-radius:10px;border:1px solid var(--neutral-border)"></div>
        <input id="fTags" placeholder="Tags (comma separated)" style="padding:10px;border-radius:10px;border:1px solid var(--neutral-border)">
        <input id="fDownload" placeholder="Download URL" style="padding:10px;border-radius:10px;border:1px solid var(--neutral-border)">
        <select id="fFeatured" style="padding:10px;border-radius:10px;border:1px solid var(--neutral-border)"><option value="FALSE">Featured: FALSE</option><option value="TRUE">Featured: TRUE</option></select>
        <input id="fScreens" placeholder="Screenshot URLs (comma)" style="padding:10px;border-radius:10px;border:1px solid var(--neutral-border)">
      </div>

      <div style="display:flex;gap:8px;margin-top:10px">
        <button id="saveBtn" type="submit" class="btn" style="background:var(--p39);color:#fff">Add / Save</button>
        <button id="clearFormBtn" type="button" class="btn" style="background:#fff">Clear</button>
        <input id="importArea" placeholder="Paste JSON to import" style="padding:10px;border-radius:10px;border:1px solid var(--neutral-border);flex:1">
        <button id="importBtn" type="button" class="btn" style="background:#fff">Import</button>
      </div>
    </form>

    <div id="adminList" class="admin-list"></div>
  </div>
</div>

<script>
/* ====== Data & helpers ====== */
document.getElementById('year').innerText = new Date().getFullYear?.() || new Date().getFullYear();
const LS_KEY = 'getandroid_mobile_v1';
let APPS = [];

const FIXED_CATS = [
"Art & Design","Auto & Vehicles","Books & Reference","Business","Comics","Communication","Dating","Education",
"Emulator","Entertainment","Finance","Food & Drink","Health & Fitness","Lifestyle","Maps & Navigation","Medical",
"Music","Music & Audio","News & Magazines","Personalization","Photography","Productivity","Shopping","Sport",
"Tools","Travel & Local","Video Players & Editors","Weather"
];

function uid(){ return 'id_' + Math.random().toString(36).slice(2,9); }
function save(){ localStorage.setItem(LS_KEY, JSON.stringify(APPS)); }
function load(){ try{ return JSON.parse(localStorage.getItem(LS_KEY)||'[]'); }catch(e){ return []; } }
function esc(s){ if(!s) return ''; return String(s).replace(/[&<>"']/g,c=>({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'})[c]); }

/* seed sample if empty */
function seedIfEmpty(){
  APPS = load();
  if(APPS && APPS.length) return;
  const names=["Spotify","TikTok","Netflix","SnapTube","YouTube Vanced","KineMaster","Nova Launcher","WhatsApp Plus","Telegram","MX Player","Gboard","Instagram"];
  const cats=["Music","Social","Entertainment","Tools","Games","Productivity"];
  const icons=["https://i.ibb.co/0Q2JbZ9/app1.png","https://i.ibb.co/1rK3X6s/app2.png","https://i.ibb.co/3k9v0sL/app3.png","https://i.ibb.co/5F2Kf8n/app4.png"];
  APPS = [];
  for(let i=0;i<36;i++){
    APPS.push({
      id: uid(),
      Title: names[i % names.length] + (i?(' '+(i+1)):''),
      ShortDesc: "Premium unlocked",
      Version: `${Math.floor(Math.random()*5)+1}.${Math.floor(Math.random()*10)}.${Math.floor(Math.random()*90)}`,
      Size: `${Math.floor(Math.random()*200)+8}M`,
      Premium: (Math.random()>0.6) ? "Premium Unlocked" : "",
      IconURL: icons[i % icons.length],
      Category: cats[i % cats.length],
      Tags: "mod,latest",
      DownloadURL: "#",
      Featured: (i<6)?'TRUE':'FALSE',
      ScreenshotURLs: ""
    });
  }
  save();
}

/* ====== Render sections (mobile-first) ====== */
function render(){
  // Indispensable (first 6)
  const ind = document.getElementById('indispensable');
  ind.innerHTML = APPS.slice(0,6).map((a,i)=>`
    <div class="card" role="button" tabindex="0" onclick="openModal('${a.id}')">
      <div class="icon" style="background:var(--p${19+i})"><img src="${esc(a.IconURL)}" alt=""></div>
      <div class="meta"><h4>${esc(a.Title)}</h4><p>${esc(a.ShortDesc)} ${a.Version?(' • v'+esc(a.Version)):''}</p><div class="small">${esc(a.Category||'')}</div></div>
    </div>
  `).join('');

  // editors (3)
  const ed = document.getElementById('editors');
  ed.innerHTML = APPS.slice(6,9).map((a,i)=>`
    <div class="card" onclick="openModal('${a.id}')">
      <div class="icon" style="background:var(--p${25+i})"><img src="${esc(a.IconURL)}" alt=""></div>
      <div class="meta"><h4>${esc(a.Title)}</h4><p>${esc(a.ShortDesc)}</p></div>
    </div>
  `).join('');

  // games
  document.getElementById('games').innerHTML = APPS.slice(9,18).map(a=>`
    <div class="card" onclick="openModal('${a.id}')">
      <div class="icon"><img src="${esc(a.IconURL)}" alt=""></div>
      <div class="meta"><h4>${esc(a.Title)}</h4><p>${esc(a.ShortDesc)}</p></div>
    </div>
  `).join('');

  // premium
  document.getElementById('premium').innerHTML = APPS.slice(18,30).map(a=>`
    <div class="card" onclick="openModal('${a.id}')">
      <div class="icon"><img src="${esc(a.IconURL)}" alt=""></div>
      <div class="meta"><h4>${esc(a.Title)}</h4><p>${esc(a.ShortDesc)}</p></div>
    </div>
  `).join('');

  // categories
  const cats = Array.from(new Set(APPS.map(a=> a.Category || 'Other')));
  document.getElementById('categories').innerHTML = cats.map(c=>`<div class="featured-item" onclick="filterByCategory('${encodeURIComponent(c)}')"><div class="thumb" style="background:var(--p34)"></div><div class="title">${esc(c)}</div></div>`).join('');

  // featured list (6)
  const featured = APPS.filter(a => (a.Featured||'').toString().toLowerCase()==='true').slice(0,6);
  document.getElementById('featuredList') && (document.getElementById('featuredList').innerHTML = featured.map((f,idx)=>`
    <div class="featured-item"><div class="thumb" style="background:var(--p${13+idx})"><img src="${esc(f.IconURL)}" alt=""></div><div class="title">${esc(f.Title)}</div></div>
  `).join(''));
}

/* ====== Modal ====== */
function openModal(id){
  const a = APPS.find(x=>x.id===id); if(!a) return;
  document.getElementById('modalTitle').innerText = a.Title || '';
  document.querySelector('#modalIcon img').src = a.IconURL || '';
  document.getElementById('modalDesc').innerText = a.ShortDesc || '';
  document.getElementById('modalMeta').innerHTML = `${a.Version?('<span class="small">v '+esc(a.Version)+'</span>') : ''} ${a.Size?('<span class="small"> • '+esc(a.Size)+'</span>') : ''}`;
  const url = a.DownloadURL || '#';
  const dl = document.getElementById('modalDownload');
  dl.href = url;
  dl.onclick = function(e){ if(!url || url === '#'){ e.preventDefault(); alert('Download link নেই।'); return false; } const key='dl::'+a.id; const prev = parseInt(localStorage.getItem(key)||'0',10); localStorage.setItem(key,String(prev+1)); document.getElementById('modalDLCount').innerText = 'Downloads: '+(prev+1); window.open(url,'_blank'); return false; };
  document.getElementById('modalCopy').onclick = async function(){ if(!url || url === '#'){ alert('Download link নেই।'); return; } try{ await navigator.clipboard.writeText(url); this.innerText='Copied!'; setTimeout(()=>this.innerText='Copy link',1000);}catch(e){ alert('Copy failed'); } };
  document.getElementById('modalOpen').href = url;
  document.getElementById('modalDLCount').innerText = 'Downloads: ' + (parseInt(localStorage.getItem('dl::'+a.id)||'0',10));
  document.getElementById('modalBackdrop').style.display = 'flex';
}
function closeModal(){ document.getElementById('modalBackdrop').style.display = 'none'; }
document.addEventListener('keydown', e=>{ if(e.key==='Escape') closeModal(); });

/* ====== Admin: 4x click on brand to open ====== */
let logoClicks=0, logoTimer=null;
document.getElementById('logoArea').addEventListener('click', function(){
  logoClicks++;
  if(logoClicks===4){ openAdmin(); logoClicks=0; clearTimeout(logoTimer); logoTimer=null; return; }
  clearTimeout(logoTimer); logoTimer = setTimeout(()=>{ logoClicks=0; logoTimer=null; }, 1200);
});
function openAdmin(){ document.getElementById('adminBackdrop').style.display='flex'; populateCategorySelect(); renderAdminList(); }
function closeAdmin(){ document.getElementById('adminBackdrop').style.display='none'; }

/* Admin form logic (mobile friendly) */
let editingId = null;
const form = document.getElementById('appForm');
form && form.addEventListener('submit', function(e){
  e.preventDefault();
  const chosen = document.getElementById('fCategorySelect').value;
  const category = (chosen === '__new__') ? (document.getElementById('fCategoryNew').value.trim() || 'Other') : chosen;
  const obj = {
    id: editingId || uid(),
    Title: document.getElementById('fTitle').value.trim(),
    ShortDesc: document.getElementById('fShort').value.trim(),
    Version: document.getElementById('fVersion').value.trim(),
    Size: document.getElementById('fSize').value.trim(),
    Premium: document.getElementById('fPremium').value.trim(),
    IconURL: document.getElementById('fIcon').value.trim(),
    Category: category,
    Tags: document.getElementById('fTags').value.trim(),
    DownloadURL: document.getElementById('fDownload').value.trim(),
    Featured: document.getElementById('fFeatured') ? document.getElementById('fFeatured').value : 'FALSE',
    ScreenshotURLs: document.getElementById('fScreens').value.trim()
  };
  if(editingId){
    const idx = APPS.findIndex(x=>x.id===editingId); if(idx!==-1) APPS[idx]=obj; editingId=null;
  } else { APPS.unshift(obj); }
  save(); render(); form.reset(); document.getElementById('newCategoryWrap').style.display='none';
});

/* populate categories select */
function populateCategorySelect(selVal){
  const sel = document.getElementById('fCategorySelect');
  if(!sel) return;
  sel.innerHTML = '';
  const d = document.createElement('option'); d.value=''; d.text='-- Select category --'; sel.appendChild(d);
  FIXED_CATS.forEach(c=>{ const o=document.createElement('option'); o.value=c; o.text=c; sel.appendChild(o); });
  const n = document.createElement('option'); n.value='__new__'; n.text='Add new category...'; sel.appendChild(n);
  if(selVal){ const found = Array.from(sel.options).find(o=>o.value===selVal); if(found) sel.value=selVal; else { sel.value='__new__'; document.getElementById('newCategoryWrap').style.display='block'; document.getElementById('fCategoryNew').value = selVal; } }
}
document.getElementById('fCategorySelect') && document.getElementById('fCategorySelect').addEventListener('change', function(){ if(this.value==='__new__'){ document.getElementById('newCategoryWrap').style.display='block'; } else { document.getElementById('newCategoryWrap').style.display='none'; document.getElementById('fCategoryNew').value=''; } });

/* admin list render & actions */
function renderAdminList(filter=''){
  const out = document.getElementById('adminList');
  out.innerHTML = APPS.filter(a=>{
    if(!filter) return true;
    const q=filter.toLowerCase(); return (a.Title||'').toLowerCase().includes(q) || (a.ShortDesc||'').toLowerCase().includes(q);
  }).map(a=>`
    <div style="display:flex;justify-content:space-between;align-items:center;padding:8px;border-bottom:1px solid rgba(0,0,0,0.05)">
      <div style="display:flex;gap:10px;align-items:center">
        <div style="width:46px;height:46px;border-radius:8px;overflow:hidden;background:#eee"><img src="${esc(a.IconURL)}" style="width:100%;height:100%;object-fit:cover"></div>
        <div><div style="font-weight:700">${esc(a.Title)}</div><div class="small">${esc(a.Category||'')}</div></div>
      </div>
      <div style="display:flex;gap:8px">
        <button onclick="startEdit('${a.id}')" class="btn" style="background:#fff">Edit</button>
        <button onclick="deleteApp('${a.id}')" class="btn" style="background:#ffd6d6">Delete</button>
      </div>
    </div>
  `).join('');
}
function startEdit(id){
  const a = APPS.find(x=>x.id===id); if(!a) return;
  editingId = id;
  document.getElementById('fTitle').value = a.Title || '';
  document.getElementById('fShort').value = a.ShortDesc || '';
  document.getElementById('fVersion').value = a.Version || '';
  document.getElementById('fSize').value = a.Size || '';
  document.getElementById('fPremium').value = a.Premium || '';
  document.getElementById('fIcon').value = a.IconURL || '';
  populateCategorySelect(a.Category);
  document.getElementById('fTags').value = a.Tags || '';
  document.getElementById('fDownload').value = a.DownloadURL || '';
  document.getElementById('fFeatured') && (document.getElementById('fFeatured').value = a.Featured || 'FALSE');
  document.getElementById('fScreens').value = a.ScreenshotURLs || '';
  window.scrollTo({top:0,behavior:'smooth'});
}
function deleteApp(id){ if(!confirm('আপনি কি মুছে ফেলতে চান?')) return; APPS = APPS.filter(a=>a.id!==id); save(); render(); }

/* import/export handlers */
document.getElementById('importBtn') && document.getElementById('importBtn').addEventListener('click', function(){
  const raw = document.getElementById('importArea').value.trim(); if(!raw) return alert('Paste JSON array here.');
  try{ const arr = JSON.parse(raw); if(!Array.isArray(arr)) return alert('JSON must be array.'); const norm = arr.map(o=>({ id:o.id||uid(), Title:o.Title||o.name||'Untitled', ShortDesc:o.ShortDesc||'', Version:o.Version||'', Size:o.Size||'', Premium:o.Premium||'', IconURL:o.IconURL||o.icon||'', Category:o.Category||'', Tags:o.Tags||'', DownloadURL:o.DownloadURL||o.download||'#', Featured:(o.Featured||'').toString().toUpperCase()==='TRUE'?'TRUE':'FALSE', ScreenshotURLs:o.ScreenshotURLs||'' })); APPS = norm.concat(APPS); save(); render(); alert('Imported '+norm.length+' apps.'); document.getElementById('importArea').value=''; }catch(e){ alert('Invalid JSON: '+e.message); }
});
document.getElementById('exportJsonBtn') && document.getElementById('exportJsonBtn').addEventListener('click', function(){ const txt = JSON.stringify(APPS, null, 2); navigator.clipboard.writeText(txt).then(()=>alert('JSON copied to clipboard'), ()=>{ const w=window.open(); w.document.write('<pre>'+txt+'</pre>'); }); });

/* ====== Search (mobile-first) ====== */
document.getElementById('search').addEventListener('input', function(){
  const q = this.value.trim().toLowerCase();
  const sr = document.getElementById('searchResults');
  if(!q){ sr.style.display='none'; document.getElementById('newsSection').style.display=''; document.getElementById('appsSection').style.display=''; document.getElementById('editorsSection').style.display=''; document.getElementById('gamesSection').style.display=''; document.getElementById('premiumSection').style.display=''; document.getElementById('categoriesSection').style.display=''; render(); return; }
  // matches
  const matches = APPS.filter(a => ((a.Title||'')+' '+(a.ShortDesc||'')+' '+(a.Tags||'')+' '+(a.Category||'')).toLowerCase().includes(q));
  document.getElementById('newsSection').style.display='none';
  document.getElementById('appsSection').style.display='none';
  document.getElementById('editorsSection').style.display='none';
  document.getElementById('gamesSection').style.display='none';
  document.getElementById('premiumSection').style.display='none';
  document.getElementById('categoriesSection').style.display='none';
  sr.style.display='block'; document.getElementById('resultsCount').innerText = matches.length + ' result(s)';
  document.getElementById('resultsGrid').innerHTML = matches.map(a=>`
    <div class="card" onclick="openModal('${a.id}')">
      <div class="icon"><img src="${esc(a.IconURL)}" alt=""></div>
      <div class="meta"><h4>${esc(a.Title)}</h4><p class="small">${esc(a.Category||'')}</p></div>
    </div>
  `).join('');
});

/* ====== Side menu open/close ====== */
const sideMenuEl = document.getElementById('sideMenu'), sideBackdrop = document.getElementById('sideBackdrop');
document.getElementById('hambBtn').addEventListener('click', openSide);
document.getElementById('sideCloseBtn').addEventListener('click', closeSide);
function openSide(){ sideMenuEl.classList.add('open'); document.getElementById('sideBackdrop').style.display='block'; sideMenuEl.setAttribute('aria-hidden','false'); }
function closeSide(){ sideMenuEl.classList.remove('open'); document.getElementById('sideBackdrop').style.display='none'; sideMenuEl.setAttribute('aria-hidden','true'); }

/* utils: filter by category */
function filterByCategory(enc){ const c = decodeURIComponent(enc).toLowerCase(); const matches = APPS.filter(a=> (a.Category||'').toLowerCase()===c); document.getElementById('newsSection').style.display='none'; document.getElementById('appsSection').style.display='none'; document.getElementById('editorsSection').style.display='none'; document.getElementById('gamesSection').style.display='none'; document.getElementById('premiumSection').style.display='none'; document.getElementById('categoriesSection').style.display='none'; document.getElementById('searchResults').style.display='block'; document.getElementById('resultsCount').innerText = matches.length+' result(s)'; document.getElementById('resultsGrid').innerHTML = matches.map(a=>`<div class="card" onclick="openModal('${a.id}')"><div class="icon"><img src="${esc(a.IconURL)}" alt=""></div><div class="meta"><h4>${esc(a.Title)}</h4><p class="small">${esc(a.Category||'')}</p></div></div>`).join(''); }

/* small helpers for admin search / other */
document.getElementById('adminSearch') && document.getElementById('adminSearch').addEventListener('input', function(){ renderAdminList(this.value.trim()); });
document.getElementById('closeAdminBtn') && document.getElementById('closeAdminBtn').addEventListener('click', closeAdmin);
document.getElementById('adminNewBtn') && document.getElementById('adminNewBtn').addEventListener('click', function(){ form.reset(); editingId=null; });

/* init */
seedIfEmpty(); render();

/* accessibility: close overlays on Escape */
document.addEventListener('keydown', e=>{ if(e.key==='Escape'){ closeModal(); closeAdmin(); closeSide(); } });
</script>
</body>
</html>
